---
title: 筆電當AP-WIFI基地台 WIN8 WIN7適用
category:
  - Note
date: 2014-06-01 10:33:33
tags:
- Windows
---


有時候有些地方只有有線網路，可用要用手機上網，或是有些地方Wi-Fi很弱，手機收不到呢？就是筆電發功的時候了。

<!--more-->

網路上有很多文章，說明如何用軟體達成這件事，但是因為個人堅持和一些維護世界和平的因素，所以我決定要跟微軟的內建功能奮戰。如果覺得微軟內建功能很廢(說真的，真的很廢)，其實可以不要看。

網路上也有很多文章說明，但是對於可能遇到的問題，都沒有完整的解答。我爬了很多英文網站才找到方法，雖然可能也只是治標，如果有大大知道問題如何解決，請務必留言指正(連英文論壇都找不太到啊!!)

首先基本上，要先確定筆電的無線網卡有分享功能，具體方式可以Google，我是沒遇到不行的啦。
再來以**管理員身分**打開cmd(命令提示字元)，輸入

``` bash
netsh wlan set hostednetwork mode=allow ssid=你要的名稱 key=密碼
netsh wlan start hostednetwork
```

這兩行，注意一定要以管理員身分喔，因為以後每次重開機都要重新執行這兩行，所以可以開一個記事本，輸入這兩行(名字密碼設定好)，存檔時副檔名改成.bat，開機點兩下就好。

接著是最重要的一步，開啟 控制台>網路和網際網路>網路和共用中心 右邊的變更介面卡設定。應該會看到一個新的連線(我的叫做區域連線*13)，她的網路名字是剛剛取的那個，這樣就成功一半了。

最後，找到現在連線到網路的介面卡(無限網路或有線網路)，按右鍵>內容>共用，把 允許其它網路使用者透過這台電腦的網際網路連線來連線 打勾，並選取剛剛開的新連線，手機就可以透過新連線連到筆電，再透過筆電連到網路了!!

-------------------------------------------------------------------------!!

下面才是本文重點，遇到了以下問題如何解決，基本上問題都是我遇到的，但是感覺甚麼神展開都遇到了QAQ。

一、手機卡在「正在取得IP位置」
    有些網頁可能會要你設定靜態IP，但這是懶人的作法，而且不懂網路的人很容易因為衝到IP而上不了網，目前比較具體的做法是(也許我才是懶人)打開筆電的 控制台>網路和網際網路>網路和共用中心 右邊的變更介面卡設定，在自訂Wi-Fi(是自己開的那個)上按右鍵>內容，把全部的勾都取消掉(去掉沒用的東西)，剩下 網路通訊協定第4版，在它上面點兩下，選取 使用下面的IP位置，並輸入基礎IP(可以用 192.168.137.1)，網路遮罩 255.255.255.0，下面DNS 分別輸入 8.8.8.8和4.4.4.4，這樣筆電就會有自動分配IP的功能了，只要連線，手機就可以自動得到IP位置。

二、netsh wlan start hostednetwork 時出現「The Hosted Network Couldn’t Be Started」
    這可能是某一次不小心在自己開的Wi-Fi上按了「停用」，要是他還在就啟用他，要是他很傲嬌的消失了，那只好去裝置管理員找她了(控制台>硬體和音效>裝置管理員)，基本上在網路介面卡可以找到，啟用他，要是找不到就去檢視裡按顯示隱藏的裝置。
http://www.thewindowsclub.com/the-hosted-network-couldnt-be-started

三、「An error occurred when enabling internet connection sharing. (null)」
    這是我遇到最不知道如何下手的問題了，目前推估是我砍了內建的諾頓防毒軟體，改到了系統設定，才會發生。爬了好多英文文章，統整了一些方法(我也不確定是哪個有效，反正最後就好了= =)。
首先按下 WIN鍵+R(啟動程式)，輸入services.msc，開起 服務，裡面有一堆項目，將以下幾個項目的 啟動類型(右鍵>內容)改成自動，並確定他的狀態是 啟動 的，不是就啟動他。

* Application Layer Gateway Service
* Network Connections
* Network Location Awareness (NLA)
* Plug And Play
* Remote Access Auto Connection Manager
* Remote Access Connection Manager
* Remote Procedure Call (RPC)
* Telephony

之後試試看，還是不行可以重開機看看。然後還有一點就是Windows防火牆要啟動。
http://www.winhelponline.com/blog/fix-ics-error-null-80004005-windows-7/

四、手機連上去了，但是上不了網
    這點最弔詭了，剛剛如果處理完上面的問題，防火牆因該是開著的，那接下來就「把防火牆關掉」，哀，微軟到底是有沒有問題啊!!!!!!!之後要開啟時因該就不會有問題了。


以上幾點問題，有時是隨機發生的，不一定沒開防火牆就開不了或沒關防火牆就連不上，而是在廣大的Windows設定檔裡，有某個東西影響了結果，有時候不要太執著，會死很多腦細胞的，多爬文，重開幾次機有時就好了。~__~

